---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
df <- read.csv("final_unal0.csv")
df
```

```{r}
library(gam)
b <- gam(ssim_exp ~ s(stage) + comparison_type, data = df)
summary(b)
```

```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 30)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```

```{r}
df <- read.csv("final_unal0_functions_complete.csv")
df
```


```{r}
library(gam)
# smooth for stage and an additive effect for comparison_type
b <- gam(ssim_exp ~ s(stage) + comparison_type, data = df)
summary(b)
```
```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 10)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```


```{r}
library(gam)
library(mgcv)
library(visreg)
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b1 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar(eps=.Machine$double.eps*100))
summary(b1)
visreg(b1, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
library('itsadug')
gamtabs(b1, caption='Summary of First Replicate: Functional vs Visual')
```


```{r}
gam.check(b1)

```

```{r}
plot(b1, pages = 1, scheme = 1, all.terms = TRUE, seWithMean = TRUE)
```

```{r}
library(gam)
library(mgcv)
library(visreg)
df <- read.csv("final_unal1_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b2 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar())
summary(b2)
visreg(b2, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
library('itsadug')
gamtabs(b2, caption='Summary of Second Replicate: Functional vs Visual')
```




```{r}
library(gam)
library(mgcv)
library(visreg)
df <- read.csv("final_unal2_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b3 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar())
summary(b3)
visreg(b3, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```


```{r}
library('itsadug')
gamtabs(b3, caption='Summary of Third Replicate: Functional vs Visual')
```

```{r}
library(stargazer)
stargazer(b1, b2, b3)
```



```{r}
df <- read.csv("df_color_exp_unal0.csv")
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b4 <- gam(ssim_exp_scale ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar())
summary(b4)
visreg(b4, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```


```{r}
library('itsadug')
gamtabs(b4, caption='Summary of First Replicate: Comparison Between Individual Visual Components')
```


```{r}
df <- read.csv("df_color_exp_unal1.csv")
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b5 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar())
summary(b5)
visreg(b5, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
library('itsadug')
gamtabs(b5, caption='Summary of Second Replicate: Comparison Between Individual Visual Components')
```



```{r}
df <- read.csv("df_color_exp_unal2.csv")
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b6 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = gaussian())
summary(b6)
visreg(b6, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
library('itsadug')
gamtabs(b6, caption='Summary of Third Replicate: Comparison Between Individual Visual Components')
```

```{r}
library(stargazer)
stargazer(b1, b2, b3)
```

```{r}
library(stargazer)
stargazer(b4, b5, b6)
```
```{r}
library(gtsummary)
#> #BlackLivesMatter
library(mgcv)
packageVersion("gtsummary")
tbl_regression(b6, tidy_fun = tidy_gam)
```
```{r}
# build gtsummary table
tbl <- tbl_summary(b6)

# using the {gt} package
as_gt(tbl) %>% gt::as_latex()
```


```{r}
library(gam)
library(mgcv)
library(visreg)
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
b <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = binomial(link="logit"))
summary(b)
visreg(b, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```



```{r}
# change fill and outline color manually 
ggplot(df, aes(x = ssim_exp)) +
  geom_histogram(aes(color = comparison_type, fill = comparison_type), 
                position = "identity", bins = 30, alpha = 0.4) +
  scale_color_manual(values = c("#00AFBB", "#E7B800")) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800"))
```


```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 30)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```

