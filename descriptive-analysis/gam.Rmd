---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
df <- read.csv("final_unal0.csv")
df
```

```{r}
library(gam)
b <- gam(ssim_exp ~ s(stage) + comparison_type, data = df)
summary(b)
```

```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 30)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```

```{r}
df <- read.csv("final_unal0_functions_complete.csv")
df
```


```{r}
library(gam)
# smooth for stage and an additive effect for comparison_type
b <- gam(ssim_exp ~ s(stage) + comparison_type, data = df)
summary(b)
```
```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 10)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```


```{r}
library(gam)
library(mgcv)
library(visreg)
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
b <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = cox.ph(link='identity'))
summary(b)
visreg(b, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```
```{r}
library(gam)
library(mgcv)
library(visreg)
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
b <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = gaussian())
summary(b)
visreg(b, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```




```{r}
# change fill and outline color manually 
ggplot(df, aes(x = ssim_exp)) +
  geom_histogram(aes(color = comparison_type, fill = comparison_type), 
                position = "identity", bins = 30, alpha = 0.4) +
  scale_color_manual(values = c("#00AFBB", "#E7B800")) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800"))
```


```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 30)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```

