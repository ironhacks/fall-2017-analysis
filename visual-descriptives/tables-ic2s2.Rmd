---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(mgcv)
library(visreg)
df1 <- read.csv("output/final_functions.csv")
# fit a smooth which varies by comparison_type
df1$type[df1$type == "Functions Search"] <- "Function"
df1$type[df1$type == "Visual Search"] <- "Visual"
df1$type <- factor(df1$type)
b <- gam(dist_search ~ s(stage, k = 4, fx = TRUE, by = type) + type, data = df1, family = betar(link="logit"), method = "REML")
summary(b)
#a <- lm(dist_search ~ stage * type, data = df1)
#summary(a)
#visreg(b, yvar = "dist_search", xvar = "stage", ylab= "dist_search",  by = "type", data = df1, method = "REML")
# transform from log-odds to probabilities scale, transform to 0 and 1
plot(b, pages = 1, trans = exp, shift = coef(b)[1], shade = TRUE, shade.col = "lightgreen", col= "purple")
plot(b, shade = TRUE, pages = 1, scale = 0, seWithMean = TRUE)
```
```{r}
library(mgcv)
library(visreg)
df2 <- read.csv("output/functions_data.csv")
# fit a smooth which varies by comparison_type
df2$type <- factor(df2$type)
b <- gam(dist_search ~ s(stage, k = 4, fx = TRUE, by = type) + type, data = df2, family = betar(link="logit"), method = "REML")
summary(b)
#a <- lm(dist_search ~ stage * type, data = df1)
#summary(a)
#visreg(b, yvar = "dist_search", xvar = "stage", ylab= "dist_search",  by = "type", data = df1, method = "REML")
# transform from log-odds to probabilities scale, transform to 0 and 1
plot(b, pages = 1, trans = plogis, shift = coef(b)[1], shade = TRUE, shade.col = "lightgreen", col= "purple")
plot(b, shade = TRUE, pages = 1, scale = 0, seWithMean = TRUE)
```
```{r}
library(mgcv)
library(visreg)
df3 <- read.csv("output/visual_data.csv")
# fit a smooth which varies by comparison_type
df3$type <- factor(df3$type)
b <- gam(dist_search ~ s(stage, k = 4, fx = TRUE, by = type) + type, data = df3, family = betar(link="logit"), method = "REML")
summary(b)
#a <- lm(dist_search ~ stage * type, data = df1)
#summary(a)
#visreg(b, yvar = "dist_search", xvar = "stage", ylab= "dist_search",  by = "type", data = df1, method = "REML")
# transform from log-odds to probabilities scale, transform to 0 and 1
plot(b, pages = 1, trans = plogis, shift = coef(b)[1], shade = TRUE, shade.col = "lightgreen", col= "purple")
plot(b, shade = TRUE, pages = 1, scale = 0, seWithMean = TRUE)
```


```{r}
library(mgcv)
library(visreg)
df5 <- read.csv("output/final_visual.csv")
#df2 <- subset(df, df$type != "simple")  
# fit a smooth which varies by comparison_type
df5$type <- factor(df5$type)
b3 <- gam(dist_search ~ s(stage, k = 4, fx = TRUE, by = type) + type, data = df5, family = betar(link="logit"), method = "REML")
summary(b3)
#visreg(b2, xvar = "stage", by = "type", data = df2, method = "REML")
plot(b3, pages = 1, trans = plogis, shift = coef(b)[1], shade = TRUE, shade.col = "lightgreen", col= "purple")
plot(b3, shade = TRUE, pages = 1, scale = 0, seWithMean = TRUE)
```


```{r}
library(mgcv)
library(visreg)
df4 <- read.csv("output/functions_visual_data.csv")
df4$type[df4$type == "Functions Search"] <- "Function"
df4$type[df4$type == "Visual Search"] <- "Visual"
df4$type[df4$type == " Search"] <- "Data"
# fit a smooth which varies by comparison_type
df4$type <- factor(df4$type)
b2 <- gam(dist_search ~ s(stage, k = 4, fx = TRUE, by = type) + type, data = df4, family = betar(link="logit"), method = "REML")
summary(b2)
#visreg(b2, xvar = "stage", by = "type", data = df2, method = "REML")
plot(b2, pages = 1, trans = plogis, shift = coef(b)[1], shade = TRUE, shade.col = "lightgreen", col= "purple")
plot(b2, shade = TRUE, pages = 1, scale = 0, seWithMean = TRUE)
```



```{r}
library('itsadug')
gamtabs(b, caption="Visual Search vs Functions Search")
```

```{r}
library('itsadug')
gamtabs(b2, caption="Visual Search of Complete Web Applications, Maps and Charts")
```
```{r}
library('itsadug')
gamtabs(b3, caption="Visual Search of Complete Web Applications, Maps and Charts")
```




```{r}
library(modelsummary)
options("modelsummary_format_numeric_latex" = "plain")
models <- list(
"Model 1" =  gam(dist_search ~ s(stage, k = 4, fx = TRUE, by = type) + type, data = df1, family = betar(link="logit"), method = "REML"),
"Model 2" =  gam(dist_search ~ s(stage, k = 4, fx = TRUE, by = type) + type, data = df4, family = betar(link="logit"), method = "REML"),
"Model 3" = gam(dist_search ~ s(stage, k = 4, fx = TRUE, by = type) + type, data = df5, family = betar(link="logit"), method = "REML")
)

modelsummary(models, output = "latex",
             estimate = "estimate",
             stars = TRUE,              
             statistic = c("Std.Error" = "std.error", 
                           "t-value" = "statistic"))
```

