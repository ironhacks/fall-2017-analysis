---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
df <- read.csv("final_unal0.csv")
df
```

```{r}
library(gam)
b <- gam(ssim_exp ~ s(stage) + comparison_type, data = df)
summary(b)
```

```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 30)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```

```{r}
df <- read.csv("final_unal0_functions_complete.csv")
df
```


```{r}
library(gam)
# smooth for stage and an additive effect for comparison_type
b <- gam(ssim_exp ~ s(stage) + comparison_type, data = df)
summary(b)
```
```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 10)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```


```{r}
library(mgcv)
library(visreg)
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b1 <- gam(ssim_exp_scale ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar(link = "logit", eps=.Machine$double.eps*1000))
summary(b1)
visreg(b1, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
library(ggplot2)
# Interleaved histograms
ggplot(df, aes(x=ssim_exp_scale, fill=comparison_type)) +
    geom_histogram(binwidth=.5, position="dodge")
```

```{r}
# Density plots with semi-transparent fill
ggplot(df, aes(x=ssim_exp_scale, fill=comparison_type)) + geom_density(alpha=.3)
```
```{r}
library('brms')
library('lmerTest')
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a0 <- lm(ssim_exp_scale ~ factor(comparison_type), data = df)
summary(a0)
```
```{r}
t.test(df$ssim_exp_scale[df$comparison_type == 'functions'], df$ssim_exp_scale[df$comparison_type == 'complete'] )
```

```{r}
library('brms')
library('lmerTest')
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a0_a <- lm(ssim_exp_scale ~ comparison_type + factor(link1_change), data = df)
summary(a0_a)
```
```{r}
library(ggplot2)
ggplot(df, aes(x = comparison_type, ssim_exp_scale)) + facet_wrap(~link1_change) + geom_jitter(width = 0.1, height = 0.1)
```



```{r}
library('lme4')
library('brms')
library('lmerTest')
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a0_b <- lmer(ssim_exp_scale ~ comparison_type + (1 | link1_change), data = df)
summary(a0_b)
```
```{r}
library('lme4')
library('brms')
library('lmerTest')
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a0_c <- lmer(ssim_exp_scale ~ comparison_type + (comparison_type | link1_change), data = df)
summary(a0_c)
```
```{r}
library('lme4')
library('brms')
library('lmerTest')
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a0_d <- brm(ssim_exp_scale ~ comparison_type , data = df, iter = 1000, prior = NULL)
summary(a0_d)
```

```{r}
visreg(a0_d)
```


```{r}
get_prior(ssim_exp_scale ~ comparison_type + (comparison_type | link1_change), data = df)
```
```{r}
library('lme4')
library('brms')
library('lmerTest')
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a0_e <- brm(ssim_exp_scale ~ comparison_type + (comparison_type | link1_change), data = df, iter = 3000, control = list( adapt_delta = .99))
summary(a0_e)
```

```{r}
visreg(a0_e)
```



```{r}
library('lme4')
library('brms')
library('lmerTest')
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a0_e <- brm(ssim_exp_scale ~ comparison_type + (comparison_type | link1_change), data = df, iter = 1000, family = zero_one_inflated_beta())
summary(a0_e)
```


```{r}
library('brms')
library('lmerTest')
df <- read.csv("final_unal0_functions_complete.csv")
print(df)
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a1 <- brm(ssim_exp_scale ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = zero_one_inflated_beta(), iter = 3000)
summary(a1)
```

```{r}
msms <- conditional_smooths(a1)
plot(msms)
```
```{r}
pp_check(a1, ndraws = 100)
```



```{r}
msms <- conditional_effects(a1)
plot(msms)
```


```{r}
library(sjstats)
performance::r2(a1)
```

```{r}
library(mgcv)
library(visreg)
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a2 <- gam(ssim_exp_scale ~ s(stage, k = 3, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = gaussian())
summary(a2)
visreg(a2, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```
```{r}
# Density plots with semi-transparent fill
library(ggplot2)
ggplot(df, aes(x=ssim_exp_scale, fill=comparison_typed)) + geom_density(alpha=.3)
```



```{r}
library(mgcv)
library(visreg)
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a2 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar())
summary(a2)
visreg(a2, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```
```{r}
plot.gam(a2$gam, residuals = TRUE, pch =1, cex = 1, shade = 
         TRUE, shade.col = "lightblue", seWithMean = TRUE, 
         pages = 1, all.terms = TRUE)
```



```{r}
install.packages(c("MCMCglmm", "arm"), dependencies=TRUE)    
library(MCMCglmm)
library(arm)
sm1<-sim(a2,1000)
smfixef=sm1@fixef
smfixef=as.mcmc(smfixef)
```




```{r}
library('itsadug')
gamtabs(a2, caption='Summary of First Replicate: Functional vs Visual')
```


```{r}
gam.check(a2)

```

```{r}
plot(b1, pages = 1, scheme = 1, all.terms = TRUE, seWithMean = TRUE)
```

```{r}
library(gam)
library(mgcv)
library(visreg)
df <- read.csv("final_unal1_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b2 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar())
summary(b2)
visreg(b2, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
library('itsadug')
gamtabs(b2, caption='Summary of Second Replicate: Functional vs Visual')
```




```{r}
library(mgcv)
library(visreg)
df <- read.csv("final.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b3 <- gam(ssim_exp_new ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar())
summary(b3)
visreg(b3, xvar = "stage", by = "comparison_type", data = df, method = "REML")

```


```{r}
library('itsadug')
gamtabs(b3, caption='Summary of Third Replicate: Functional vs Visual')
```

```{r}
library(stargazer)
stargazer(b1, b2, b3)
```



```{r}
df <- read.csv("df_color_exp_unal0.csv")
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b4 <- gam(ssim_exp_scale ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = gaussian())
summary(b4)
visreg(b4, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```


```{r}
df <- read.csv("df_color_exp_unal0.csv")
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b4 <- brm(ssim_exp_scale ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = zero_one_inflated_beta(), iter = 12000, cores = 4)
summary(b4)

```
```{r}
msms <- conditional_smooths(b4)
plot(msms)
```


```{r}
library('itsadug')
gamtabs(b4, caption='Summary of First Replicate: Comparison Between Individual Visual Components')
```


```{r}
df <- read.csv("df_color_exp_unal1.csv")
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b5 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar())
summary(b5)
visreg(b5, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
library('itsadug')
gamtabs(b5, caption='Summary of Second Replicate: Comparison Between Individual Visual Components')
```



```{r}
df <- read.csv("df_color_exp_unal2.csv")
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
b6 <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = gaussian())
summary(b6)
visreg(b6, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
library('brms')
library('lmerTest')
df <- read.csv("df_color_exp_unal0.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a1 <- brm(ssim_exp_scale ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = zero_one_inflated_beta(), iter = 1000)
summary(a1)
```



```{r}
library('itsadug')
gamtabs(b6, caption='Summary of Third Replicate: Comparison Between Individual Visual Components')
```

```{r}
library(stargazer)
stargazer(b1, b2, b3)
```

```{r}
library(stargazer)
stargazer(b4, b5, b6)
```
```{r}
library(gtsummary)
#> #BlackLivesMatter
library(mgcv)
packageVersion("gtsummary")
tbl_regression(b6, tidy_fun = tidy_gam)
```
```{r}
# build gtsummary table
tbl <- tbl_summary(b6)

# using the {gt} package
as_gt(tbl) %>% gt::as_latex()
```


```{r}
library(mgcv)
library(visreg)
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
b <- gam(ssim_exp ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = betar(link="logit"))
summary(b)
visreg(b, xvar = "stage", by = "comparison_type", data = df, method = "REML")
```

```{r}
## Interactions
df <- read.csv("final_unal0_functions_complete.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
fit.in1 <- lm(ssim_exp_scale ~ stage*comparison_type, data=df)
visreg(fit.in1, "stage", by="comparison_type")
summary(fit.in1)
```


```{r}
# change fill and outline color manually 
ggplot(df, aes(x = ssim_exp)) +
  geom_histogram(aes(color = comparison_type, fill = comparison_type), 
                position = "identity", bins = 30, alpha = 0.4) +
  scale_color_manual(values = c("#00AFBB", "#E7B800")) +
  scale_fill_manual(values = c("#00AFBB", "#E7B800"))
```


```{r}
library(dplyr)
df %>% mutate_if(is.character, as.factor)
library(ggplot2)
gg.ns30 <- ggplot(df,aes(x=stage, y=ssim_exp,col=comparison_type))+geom_point()+
  geom_smooth(method='gam',formula=y ~ splines::bs(x, 30)) + facet_grid(comparison_type ~.)
print(gg.ns30)
```

```{r}
library('brms')
library('lmerTest')
library('mgcv')
df <- read.csv("df_color_exp_unal0.csv")
# fit a smooth which varies by comparison_type
df$comparison_type <- factor(df$comparison_type)
# separate smooth functions for each level of the factor 
# each has its own smoothness parameter 
# centred ( no group means ) so include factor as a fixed effect
a1 <- gam(ssim_exp_scale ~ s(stage, k = 4, fx = TRUE, by = comparison_type) + comparison_type, data = df, family = zero_one_inflated_beta())
summary(a1)
```

